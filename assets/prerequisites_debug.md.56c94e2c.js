import{_ as s,o as a,c as p,S as n}from"./chunks/framework.db42f85d.js";const u=JSON.parse('{"title":"使用VSCode调试源码","description":"","frontmatter":{},"headers":[],"relativePath":"prerequisites/debug.md","filePath":"prerequisites/debug.md"}'),o={name:"prerequisites/debug.md"},l=n(`<h1 id="使用vscode调试源码" tabindex="-1">使用VSCode调试源码 <a class="header-anchor" href="#使用vscode调试源码" aria-label="Permalink to &quot;使用VSCode调试源码&quot;">​</a></h1><h2 id="_1-clone-vue3源码到本地" tabindex="-1">1. clone vue3源码到本地 <a class="header-anchor" href="#_1-clone-vue3源码到本地" aria-label="Permalink to &quot;1. clone vue3源码到本地&quot;">​</a></h2><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">clone</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">https://github.com/vuejs/core.git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">vue3</span></span></code></pre></div><h2 id="_2-安装依赖" tabindex="-1">2. 安装依赖 <a class="header-anchor" href="#_2-安装依赖" aria-label="Permalink to &quot;2. 安装依赖&quot;">​</a></h2><p>使用 vscode 打开 vue3 项目，在项目中的 <a href="https://github.com/vuejs/core/blob/main/.github/contributing.md" target="_blank" rel="noreferrer">.github/contributing.md</a> 文件中，我们可以看到Vue官方对源码架构的介绍和对开发的一些介绍。</p><p>从 <a href="https://github.com/vuejs/core/blob/main/.github/contributing.md#development-setup" target="_blank" rel="noreferrer">#development-setup</a> 可以知道 Node.js 的版本需要满足 <code>&gt;= 18.12</code> 且 pnpm 的版本需要满足 <code>&gt;= 8</code>，并且 Vue3 的依赖管理是基于 pnpm 的，如果没有就执行 <code>npm i pnpm -g</code> 安装一下。</p><p>安装依赖：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span></span></code></pre></div><h2 id="_3-运行项目" tabindex="-1">3. 运行项目 <a class="header-anchor" href="#_3-运行项目" aria-label="Permalink to &quot;3. 运行项目&quot;">​</a></h2><p><a href="https://github.com/vuejs/core/blob/main/.github/contributing.md#scripts" target="_blank" rel="noreferrer">#scripts</a> 介绍了vue3提供的打包</p><p>看到 <code>nr dev</code> (需要安装 <code>ni</code> npm 包)，该命令等价于 <code>npm run dev</code></p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4598b29d47c04ad7be46d6fe2e6a98af~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1035&amp;h=477&amp;s=53188&amp;e=png&amp;b=ffffff" alt="image.png"></p><p>执行该命令:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 加上 -s 参数会生成对应的 source map 文件，用于 debug 调试</span></span>
<span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">run</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">dev</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-s</span></span></code></pre></div><p>然后再 <code>packages/vue</code> 目录下会看到生成了 <code>dist</code> 目录，这就是打包后的vue3源码，<code>vue.global.js</code> 文件可以直接用于 <code>HTML</code> 中</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/adf7b248ba944079a992043037eb9f96~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=261&amp;h=96&amp;s=3477&amp;e=png&amp;b=24282f" alt="image.png"></p><h2 id="_4-跑个-demo" tabindex="-1">4. 跑个 demo <a class="header-anchor" href="#_4-跑个-demo" aria-label="Permalink to &quot;4. 跑个 demo&quot;">​</a></h2><p>在 <code>packages/vue/examples</code> 目录下，有很多官方提供的示例，可以看到它们都是一些 HTML 文件，并且都引用了 <code>vue.global.js</code> 文件</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">src</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">../../dist/vue.global.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">demo</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">...</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><p>新建 <code>debug</code> 目录，在该目录下新建 <code>hello.html</code>，内容如下：</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">src</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">../../dist/vue.global.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">app</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">{{ msg }}</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> createApp </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Vue</span></span>
<span class="line"><span style="color:#82AAFF;">createApp</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">setup</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            msg</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Hello Vue.js</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">mount</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">#app</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><p>执行 <code>npm run serve</code>，会在本地开启一个 http 服务：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">Serving!                                       </span></span>
<span class="line"><span style="color:#A6ACCD;">      - Local:    http://localhost:60741             </span></span>
<span class="line"><span style="color:#A6ACCD;">      - Network:  http://192.168.152.195:60741       </span></span>
<span class="line"><span style="color:#A6ACCD;">      This port was picked because 3000 is in use.   </span></span>
<span class="line"><span style="color:#A6ACCD;">      Copied local address to clipboard!</span></span></code></pre></div><p>在浏览器打开该地址，可以看到:</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/31a30f21a1d2498598ef7febe03f8fa7~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=574&amp;h=103&amp;s=7984&amp;e=png&amp;b=ffffff" alt="image.png"></p><h2 id="_5-使用-vscode-debug-调试" tabindex="-1">5. 使用 VSCode debug 调试 <a class="header-anchor" href="#_5-使用-vscode-debug-调试" aria-label="Permalink to &quot;5. 使用 VSCode debug 调试&quot;">​</a></h2><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4637578cf6574522a3f2c1b24f2b2075~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=407&amp;h=345&amp;s=17191&amp;e=png&amp;b=2a2e36" alt="image.png"></p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/89c0f8b06b9b416386fc8bae96fb5448~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=761&amp;h=589&amp;s=81912&amp;e=png&amp;b=262b32" alt="image.png"></p><p>添加配置，选择 <code>Chomre: Launch</code>，然后修改配置的 <code>name</code> 和 <code>url</code></p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">configurations</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">: </span><span style="color:#89DDFF;">[</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Hello Vue.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">request</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">launch</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">type</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">chrome</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">url</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://localhost:60741</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 上面你本地起的 http 服务地址</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">webRoot</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\${workspaceFolder}</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">    ...</span></span>
<span class="line"><span style="color:#89DDFF;">]</span></span></code></pre></div><p>打一个断点，点击开始调试</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e071bec530d942a1bcd8c72de7734dcf~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1920&amp;h=634&amp;s=97823&amp;e=png&amp;b=262b32" alt="image.png"></p><p>打开 <code>hello.html</code> 文件</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/78e98cfc3b21445097f9ae50e3195ee4~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=582&amp;h=292&amp;s=16305&amp;e=png&amp;b=ffffff" alt="image.png"></p><p>可以看到，成功进入断点</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5d27b1ce1c734e4fada25bd56e91a8f9~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1456&amp;h=875&amp;s=95531&amp;e=png&amp;b=272b33" alt="image.png"></p><p>接下来就可以愉快的调试源码了！</p>`,37),e=[l];function t(c,r,D,i,y,F){return a(),p("div",null,e)}const m=s(o,[["render",t]]);export{u as __pageData,m as default};
